<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MissImp Test • MissImp</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="MissImp Test">
<meta property="og:description" content="MissImp">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MissImp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/A_Generate_Missingness_and_Tests_MCAR.html">Generation of Missingness and Tests of MCAR</a>
    </li>
    <li>
      <a href="../articles/B_MissImp_Test.html">MissImp Test</a>
    </li>
    <li>
      <a href="../articles/C_Each_Imputation_Method.html">Imputation for each method</a>
    </li>
    <li>
      <a href="../articles/D_oracle_simple_test.html">Oracle Simple Test</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="B_MissImp_Test_files/header-attrs-2.10/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>MissImp Test</h1>
                        <h4 class="author">Xuwen Liu</h4>
            
            <h4 class="date">2022-03-17</h4>
      
      
      <div class="hidden name"><code>B_MissImp_Test.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">stats</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">MissImp</span><span class="op">)</span>
<span class="co"># knitr::opts_chunk$set(eval = FALSE)</span></code></pre></div>
<div id="test-on-the-abalone-data" class="section level1">
<h1 class="hasAnchor">
<a href="#test-on-the-abalone-data" class="anchor"></a>Test on the abalone data</h1>
<p>In the package, 100 rows of the abalone dataset is stored to test different functions.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="st">'../data/test_abalone.rda'</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">abalone_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">test_abalone</span><span class="op">)</span>
<span class="va">col_num</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span>
<span class="va">col_dis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">8</span><span class="op">)</span>
<span class="va">col_cat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">9</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="va">col_num</span><span class="op">)</span> <span class="op">{</span>
  <span class="kw">if</span> <span class="op">(</span><span class="va">j</span> <span class="op">%in%</span> <span class="va">col_dis</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/base/warning.html">suppressWarnings</a></span><span class="op">(</span><span class="va">abalone_data</span><span class="op">[</span>, <span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="va">abalone_data</span><span class="op">[</span>, <span class="va">j</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="kw">else</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/base/warning.html">suppressWarnings</a></span><span class="op">(</span><span class="va">abalone_data</span><span class="op">[</span>, <span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">abalone_data</span><span class="op">[</span>, <span class="va">j</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
  <span class="op">}</span>
<span class="op">}</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="va">col_cat</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">abalone_data</span><span class="op">[</span>, <span class="va">j</span><span class="op">]</span><span class="op">[</span><span class="va">abalone_data</span><span class="op">[</span>, <span class="va">j</span><span class="op">]</span> <span class="op">==</span> <span class="st">"?"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span>
  <span class="fu"><a href="https://rdrr.io/r/base/warning.html">suppressWarnings</a></span><span class="op">(</span><span class="va">abalone_data</span><span class="op">[</span>, <span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">abalone_data</span><span class="op">[</span>, <span class="va">j</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>
<span class="va">abalone_data</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="va">abalone_data</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">abalone_data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">abalone_data</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">abalone_data</span><span class="op">)</span></code></pre></div>
<pre><code>##      V2    V3    V4     V5     V6     V7    V8 V9 V1
## 1 0.455 0.365 0.095 0.5140 0.2245 0.1010 0.150 15  M
## 2 0.350 0.265 0.090 0.2255 0.0995 0.0485 0.070  7  M
## 3 0.530 0.420 0.135 0.6770 0.2565 0.1415 0.210  9  F
## 4 0.440 0.365 0.125 0.5160 0.2155 0.1140 0.155 10  M
## 5 0.330 0.255 0.080 0.2050 0.0895 0.0395 0.055  7  I
## 6 0.425 0.300 0.095 0.3515 0.1410 0.0775 0.120  8  I</code></pre>
<p>After loading and preprocessing the abalone dataset, we can create incomplete datasets with different mechanisms and proportions of missing data. Here for demonstration we chose the “MAR1” missing data mechanism and 20% missing data percentage. (More details about the generation of missing data could be found in vignette “A_Generate_Missingness_and_Tests_MCAR”)</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">X.complete</span> <span class="op">&lt;-</span> <span class="va">abalone_data</span>
<span class="va">mech</span> <span class="op">&lt;-</span> <span class="st">"MAR1"</span>
<span class="va">miss_prop</span> <span class="op">&lt;-</span> <span class="fl">0.3</span>
<span class="va">rs</span> <span class="op">&lt;-</span> <span class="fu">generate_miss</span><span class="op">(</span><span class="va">X.complete</span>, <span class="va">miss_prop</span>, mechanism <span class="op">=</span> <span class="va">mech</span><span class="op">)</span></code></pre></div>
<p>Then a model could be chosen to impute the incomplete dataset. The parameters shown below need to be chosen wisely.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">rs</span><span class="op">$</span><span class="va">X.incomp</span>
<span class="va">df_complete</span> <span class="op">&lt;-</span> <span class="va">X.complete</span>
<span class="va">col_cat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">9</span><span class="op">)</span>
<span class="va">col_dis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">8</span><span class="op">)</span>
<span class="va">col_num</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span>

<span class="va">maxiter_tree</span> <span class="op">&lt;-</span> <span class="fl">10</span>
<span class="va">maxiter_pca</span> <span class="op">&lt;-</span> <span class="fl">200</span>
<span class="va">maxiter_mice</span> <span class="op">&lt;-</span> <span class="fl">10</span>
<span class="va">ncp_pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">df_complete</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">learn_ncp</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span>

<span class="va">num_mi</span> <span class="op">&lt;-</span> <span class="fl">4</span>
<span class="va">n_resample</span> <span class="op">&lt;-</span> <span class="fl">4</span>
<span class="va">n_df</span> <span class="op">&lt;-</span> <span class="fl">5</span>

<span class="va">imp_method</span> <span class="op">&lt;-</span> <span class="st">"MI_Ranger"</span>
<span class="va">resample_method</span> <span class="op">&lt;-</span> <span class="st">"bootstrap"</span>
<span class="va">cat_combine_by</span> <span class="op">&lt;-</span> <span class="st">"onehot"</span>
<span class="va">var_cat</span> <span class="op">&lt;-</span> <span class="st">"wilcox_va"</span></code></pre></div>
<p>The initial incomplete dataset, the imputed dataset and the uncertainty for each imputed data are shown below as well as the performance matrices such as MSE(Mean Squared Error) for numerical columns and F1-score for the categorical ones (if the complete dataset is given).</p>
<p>There are two types of MSE that are calculated. The  is the normal one that compares the L2 distance between the complete dataset and the imputed one. However, in this case, the columns with higher data values could weight more in MSE than other columns. So, for , before performing the calculation of MSE, the imputed data set and complete dataset are both scaled with Min-Max scale using the parameter from complete dataset.</p>
<p>It is also normal that some lines in  are . This comes form the fact that there are too little number of resampled dataset (). If in all those resampled dataset, a certain line shows only once and thus is imputed only once, there is no calculation for the uncertainty of imputation.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></code></pre></div>
<pre><code>##      V2    V3    V4     V5     V6     V7    V8 V9   V1
## 1 0.455 0.365    NA 0.5140     NA 0.1010 0.150 15    M
## 2    NA 0.265 0.090 0.2255 0.0995 0.0485 0.070  7    M
## 3    NA 0.420 0.135 0.6770     NA 0.1415 0.210  9 &lt;NA&gt;
## 4 0.440 0.365    NA 0.5160 0.2155 0.1140 0.155 10    M
## 5 0.330 0.255 0.080 0.2050 0.0895 0.0395 0.055  7 &lt;NA&gt;
## 6    NA 0.300 0.095 0.3515 0.1410 0.0775 0.120  8    I</code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">imp</span><span class="op">)</span></code></pre></div>
<pre><code>##          V2    V3        V4     V5        V6     V7    V8 V9 V1
## 1 0.4550000 0.365 0.1229479 0.5140 0.2141118 0.1010 0.150 15  M
## 2 0.3615260 0.265 0.0900000 0.2255 0.0995000 0.0485 0.070  7  M
## 3 0.5349271 0.420 0.1350000 0.6770 0.2985792 0.1415 0.210  9  M
## 4 0.4400000 0.365 0.1189219 0.5160 0.2155000 0.1140 0.155 10  M
## 5 0.3300000 0.255 0.0800000 0.2050 0.0895000 0.0395 0.055  7  I
## 6 0.4027014 0.300 0.0950000 0.3515 0.1410000 0.0775 0.120  8  I</code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">imp.disj</span><span class="op">)</span></code></pre></div>
<pre><code>##          V2    V3        V4     V5        V6     V7    V8 V9       V1_F
## 1 0.4550000 0.365 0.1229479 0.5140 0.2141118 0.1010 0.150 15 0.00000000
## 2 0.3615260 0.265 0.0900000 0.2255 0.0995000 0.0485 0.070  7 0.00000000
## 3 0.5349271 0.420 0.1350000 0.6770 0.2985792 0.1415 0.210  9 0.12500000
## 4 0.4400000 0.365 0.1189219 0.5160 0.2155000 0.1140 0.155 10 0.00000000
## 5 0.3300000 0.255 0.0800000 0.2050 0.0895000 0.0395 0.055  7 0.04166667
## 6 0.4027014 0.300 0.0950000 0.3515 0.1410000 0.0775 0.120  8 0.00000000
##        V1_I V1_M
## 1 0.0000000 1.00
## 2 0.0000000 1.00
## 3 0.1250000 0.75
## 4 0.0000000 1.00
## 5 0.9583333 0.00
## 6 1.0000000 0.00</code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">uncertainty</span><span class="op">)</span></code></pre></div>
<pre><code>##             V2 V3           V4 V5          V6 V7 V8 V9            V1
## 1 0.000000e+00  0 7.444954e-05  0 1.85082e-05  0  0  0 -2.220446e-16
## 2 9.698183e-05  0 0.000000e+00  0 0.00000e+00  0  0  0 -2.220446e-16
## 3           NA NA           NA NA          NA NA NA NA -2.220446e-16
## 4 0.000000e+00  0 2.599316e-05  0 0.00000e+00  0  0  0 -2.220446e-16
## 5 0.000000e+00  0 0.000000e+00  0 0.00000e+00  0  0  0 -2.220446e-16
## 6 2.929702e-05  0 0.000000e+00  0 0.00000e+00  0  0  0 -2.220446e-16</code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">uncertainty.disj</span><span class="op">)</span></code></pre></div>
<pre><code>##             V2 V3           V4 V5          V6 V7 V8 V9        V1_F        V1_I
## 1 0.000000e+00  0 7.444954e-05  0 1.85082e-05  0  0  0 0.000000000 0.000000000
## 2 9.698183e-05  0 0.000000e+00  0 0.00000e+00  0  0  0 0.000000000 0.000000000
## 3           NA NA           NA NA          NA NA NA NA          NA          NA
## 4 0.000000e+00  0 2.599316e-05  0 0.00000e+00  0  0  0 0.000000000 0.000000000
## 5 0.000000e+00  0 0.000000e+00  0 0.00000e+00  0  0  0 0.005208333 0.005208333
## 6 2.929702e-05  0 0.000000e+00  0 0.00000e+00  0  0  0 0.000000000 0.000000000
##   V1_M
## 1    0
## 2    0
## 3   NA
## 4    0
## 5    0
## 6    0</code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span><span class="op">$</span><span class="va">MSE</span></code></pre></div>
<pre><code>## $list_MSE
## [1] 1.985592 1.400538 2.522999 2.358195
## 
## $Mean_MSE
## [1] 2.066831
## 
## $Variance_MSE
## [1] 0.2478427
## 
## $list_MSE_scale
## [1] 0.01526632 0.02304182 0.02182705 0.02103667
## 
## $Mean_MSE_scale
## [1] 0.02029296
## 
## $Variance_MSE_scale
## [1] 1.190996e-05</code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span><span class="op">$</span><span class="va">F1</span></code></pre></div>
<pre><code>## $list_F1
## [1] 0.5882353 0.5625000 0.4705882 0.7058824
## 
## $Mean_F1
## [1] 0.5818015
## 
## $Variance_F1
## [1] 0.009392797</code></pre>
<p>At last, we perform a simple mean imputation as the baseline imputation method. After choosing a certain column (V5 in the example), we can compare the density distribution of the missing values, the imputed values by the method chosen above and the mean imputed values.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res_mean_imp</span> <span class="op">&lt;-</span> <span class="va">df</span>
<span class="va">col_num</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span>
<span class="va">col_num_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">[</span><span class="va">col_num</span><span class="op">]</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">y</span> <span class="kw">in</span> <span class="va">col_num_name</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">res_mean_imp</span><span class="op">[[</span><span class="va">y</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">res_mean_imp</span><span class="op">[[</span><span class="va">y</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">res_mean_imp</span><span class="op">[[</span><span class="va">y</span><span class="op">]</span><span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="op">}</span>


<span class="va">ycol</span> <span class="op">&lt;-</span> <span class="st">"V5"</span>
<span class="va">X.miss</span> <span class="op">&lt;-</span> <span class="va">X.complete</span>
<span class="va">X.miss</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span>
<span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">X.complete</span><span class="op">[[</span><span class="va">ycol</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">rs</span><span class="op">$</span><span class="va">R.mask</span><span class="op">[[</span><span class="va">ycol</span><span class="op">]</span><span class="op">]</span><span class="op">]</span>, <span class="va">res</span><span class="op">$</span><span class="va">imp</span><span class="op">[[</span><span class="va">ycol</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">rs</span><span class="op">$</span><span class="va">R.mask</span><span class="op">[[</span><span class="va">ycol</span><span class="op">]</span><span class="op">]</span><span class="op">]</span>, <span class="va">res_mean_imp</span><span class="op">[[</span><span class="va">ycol</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">rs</span><span class="op">$</span><span class="va">R.mask</span><span class="op">[[</span><span class="va">ycol</span><span class="op">]</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,
  lines <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"complete"</span>, <span class="st">"imputed"</span>, <span class="st">"mean_imputed"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">rs</span><span class="op">$</span><span class="va">R.mask</span><span class="op">[[</span><span class="va">ycol</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>
<span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">y</span>, fill <span class="op">=</span> <span class="va">lines</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ycol</span><span class="op">)</span></code></pre></div>
<p><img src="B_MissImp_Test_files/figure-html/density_comp_with_mean_imp-1.png" width="700"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">X.miss</span><span class="op">[[</span><span class="va">ycol</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">rs</span><span class="op">$</span><span class="va">R.mask</span><span class="op">[[</span><span class="va">ycol</span><span class="op">]</span><span class="op">]</span><span class="op">]</span> <span class="op">-</span> <span class="va">res</span><span class="op">$</span><span class="va">imp</span><span class="op">[[</span><span class="va">ycol</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">rs</span><span class="op">$</span><span class="va">R.mask</span><span class="op">[[</span><span class="va">ycol</span><span class="op">]</span><span class="op">]</span><span class="op">]</span>, <span class="va">X.miss</span><span class="op">[[</span><span class="va">ycol</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">rs</span><span class="op">$</span><span class="va">R.mask</span><span class="op">[[</span><span class="va">ycol</span><span class="op">]</span><span class="op">]</span><span class="op">]</span> <span class="op">-</span> <span class="va">res_mean_imp</span><span class="op">[[</span><span class="va">ycol</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">rs</span><span class="op">$</span><span class="va">R.mask</span><span class="op">[[</span><span class="va">ycol</span><span class="op">]</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,
  lines <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"imputed_error"</span>, <span class="st">"mean_imputed_error"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">rs</span><span class="op">$</span><span class="va">R.mask</span><span class="op">[[</span><span class="va">ycol</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>
<span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">y</span>, fill <span class="op">=</span> <span class="va">lines</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ycol</span><span class="op">)</span></code></pre></div>
<p><img src="B_MissImp_Test_files/figure-html/density_comp_with_mean_imp-2.png" width="700"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#dat &lt;- data.frame(</span>
<span class="co">#  y = c(X.miss[[ycol]], df[[ycol]]),</span>
<span class="co">#  lines = rep(c("missing", "observed"), each = length(df[[ycol]]))</span>
<span class="co">#)</span>
<span class="co">#ggplot2::ggplot(dat, ggplot2::aes(x = y, fill = lines)) +</span>
<span class="co">#  ggplot2::geom_density(alpha = 0.3) +</span>
<span class="co">#  ggplot2::labs(x = ycol)</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Adrien Ehrhardt.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
