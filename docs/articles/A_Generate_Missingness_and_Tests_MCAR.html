<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Generation of Missingness and Tests of MCAR • MissImp</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Generation of Missingness and Tests of MCAR">
<meta property="og:description" content="MissImp">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MissImp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/A_Generate_Missingness_and_Tests_MCAR.html">Generation of Missingness and Tests of MCAR</a>
    </li>
    <li>
      <a href="../articles/B_MissImp_Test.html">MissImp Test</a>
    </li>
    <li>
      <a href="../articles/C_Each_Imputation_Method.html">Imputation for each method</a>
    </li>
    <li>
      <a href="../articles/D_oracle_simple_test.html">Oracle Simple Test</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="A_Generate_Missingness_and_Tests_MCAR_files/header-attrs-2.10/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Generation of Missingness and Tests of MCAR</h1>
                        <h4 class="author">Xuwen Liu</h4>
            
            <h4 class="date">2022-03-17</h4>
      
      
      <div class="hidden name"><code>A_Generate_Missingness_and_Tests_MCAR.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">MissImp</span><span class="op">)</span></code></pre></div>
<p>In the <a href="#generate">first section</a>, some data are generated. first, <a href="#complete">a compete mixed-type dataset</a> is drawn with 5 continuous variables, 1 integer variable and 2 categorical variables. Then given the desired missing data proportion and the missing data mechanism, based on the complete dataset, <a href="#generate">an incomplete dataset</a> with missing values is created.</p>
<p>In the <a href="#tests">second section</a> of this document “Statistical tests for MCAR”, three tests are performed to show if an incomplete dataset follows a Missing Completely At Random (MCAR) mechanism. These three tests are independently used on several generated incomplete datasets with different mechanisms, in order to show their capacity.</p>
<div id="generate" class="section level1">
<h1 class="hasAnchor">
<a href="#generate" class="anchor"></a>Generate data</h1>
<div id="complete" class="section level2">
<h2 class="hasAnchor">
<a href="#complete" class="anchor"></a>Complete data</h2>
<p>We generate a complete data set <span class="math inline">\((Y_j)_{1 \leq j \leq 8}\)</span> with <span class="math inline">\((Y_1, Y_2, Y_3) \sim \mathcal{N}(\mu_1, \Sigma_1)\)</span>, <span class="math inline">\((Y_4, Y_5) \sim \mathcal{N}(\mu_2, \Sigma_2)\)</span>, <span class="math inline">\(Y_6 \sim P(\lambda)\)</span> and <span class="math inline">\(Y_7, Y_8 \sim \text{Bin}(\gamma)\)</span>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">10000</span>
<span class="va">complete_df_generator</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">mu.X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>
  <span class="va">Sigma.X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
    <span class="fl">9</span>, <span class="fl">3</span>, <span class="fl">2</span>,
    <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">0</span>,
    <span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">1</span>
  <span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
  <span class="co"># multivariate normal distribution</span>
  <span class="va">X.complete.cont</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html">mvrnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">mu.X</span>, <span class="va">Sigma.X</span><span class="op">)</span>

  <span class="va">mu1.X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">8</span><span class="op">)</span>
  <span class="va">Sigma1.X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
    <span class="fl">16</span>, <span class="fl">14</span>,
    <span class="fl">14</span>, <span class="fl">25</span>
  <span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
  <span class="co"># multivariate normal distribution</span>
  <span class="va">X.complete.cont1</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html">mvrnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">mu1.X</span>, <span class="va">Sigma1.X</span><span class="op">)</span>

  <span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fl">4.3</span>
  <span class="co"># poisson distribution</span>
  <span class="va">X.complete.discr</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">lambda</span><span class="op">)</span>
  <span class="co"># binomial</span>
  <span class="va">X.complete.cat</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span><span class="va">n</span>, size <span class="op">=</span> <span class="fl">5</span>, prob <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span>
  <span class="co"># binomial</span>
  <span class="va">X.complete.cat2</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span><span class="va">n</span>, size <span class="op">=</span> <span class="fl">7</span>, prob <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span>

  <span class="va">X.complete</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">X.complete.cont</span>, <span class="va">X.complete.cont1</span>,
    <span class="va">X.complete.discr</span>,
    ... <span class="op">=</span> <span class="va">X.complete.cat</span>, <span class="va">X.complete.cat2</span>
  <span class="op">)</span><span class="op">)</span>
  <span class="va">X.complete</span><span class="op">[</span>, <span class="fl">7</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">X.complete</span><span class="op">[</span>, <span class="fl">7</span><span class="op">]</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">X.complete</span><span class="op">[</span>, <span class="fl">7</span><span class="op">]</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"F"</span>, <span class="st">"E"</span>, <span class="st">"D"</span>, <span class="st">"C"</span>, <span class="st">"B"</span>, <span class="st">"A"</span><span class="op">)</span>
  <span class="va">X.complete</span><span class="op">[</span>, <span class="fl">8</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">X.complete</span><span class="op">[</span>, <span class="fl">8</span><span class="op">]</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">X.complete</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Y1"</span>, <span class="st">"Y2"</span>, <span class="st">"Y3"</span>, <span class="st">"Y4"</span>, <span class="st">"Y5"</span>, <span class="st">"Y6"</span>, <span class="st">"Y7"</span>, <span class="st">"Y8"</span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">X.complete</span><span class="op">)</span>
<span class="op">}</span>
<span class="va">X.complete</span> <span class="op">&lt;-</span> <span class="fu">complete_df_generator</span><span class="op">(</span><span class="va">n</span><span class="op">)</span></code></pre></div>
</div>
<div id="missingness" class="section level2">
<h2 class="hasAnchor">
<a href="#missingness" class="anchor"></a>Add missingness</h2>
<p>We could generate incomplete dataframe from the complete dataframe, with a chosen percentage of missing data and a chosen missing mechanism. The difference between mechanisms is explained in the documentation of <code>generate_miss</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">miss_perc</span> <span class="op">&lt;-</span> <span class="fl">0.4</span>
<span class="va">rs</span> <span class="op">&lt;-</span> <span class="fu">generate_miss</span><span class="op">(</span><span class="va">X.complete</span>, <span class="va">miss_perc</span>, mechanism <span class="op">=</span> <span class="st">"MNAR1"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">rs</span><span class="op">$</span><span class="va">X.incomp</span><span class="op">)</span></code></pre></div>
<pre><code>##           Y1        Y2        Y3       Y4        Y5 Y6   Y7   Y8
## 1 -3.3845168  3.429741 1.8516238 9.180508 0.5086271  8    C &lt;NA&gt;
## 2 -5.7113518  3.451971 0.4318206 7.467294 7.6197087  0    D    3
## 3         NA  3.401392        NA       NA        NA NA &lt;NA&gt; &lt;NA&gt;
## 4 -0.9651230        NA 2.5517381 8.632511 3.7065647  6    E &lt;NA&gt;
## 5         NA -3.540198 4.0050910 3.253495 0.7486720  3 &lt;NA&gt;    4
## 6  0.6554891        NA        NA       NA        NA  3    B    2</code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">rs</span><span class="op">$</span><span class="va">R.mask</span><span class="op">)</span></code></pre></div>
<pre><code>##      Y1    Y2    Y3    Y4    Y5    Y6    Y7    Y8
## 1 FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE
## 2 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## 3  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
## 4 FALSE  TRUE FALSE FALSE FALSE FALSE FALSE  TRUE
## 5  TRUE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE
## 6 FALSE  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE</code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">rs</span><span class="op">$</span><span class="va">real_miss_perc</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.3932625</code></pre>
<p>Next, a list of incomplete dataframes is generated with every mechanism that is implemented in <code>generate_miss</code>. First a list of incomplete dataframes is generated on the continuous variables <span class="math inline">\((Y_1, \dots, Y_5)\)</span>, with the result in <code>rs.con</code>; then on the continous + discrete variables <span class="math inline">\((Y_1, \dots, Y_6)\)</span>, with the result in <code>rs.con_dis</code>; and at last on continuous + discrete + categorical variables, with the result in <code>rs.mix</code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">miss_perc</span> <span class="op">&lt;-</span> <span class="fl">0.3</span>
<span class="va">rs.con</span> <span class="op">&lt;-</span> <span class="fu">generate_miss_ls</span><span class="op">(</span><span class="va">X.complete</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, <span class="va">miss_perc</span><span class="op">)</span>
<span class="va">rs.con_dis</span> <span class="op">&lt;-</span> <span class="fu">generate_miss_ls</span><span class="op">(</span><span class="va">X.complete</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span>, <span class="va">miss_perc</span><span class="op">)</span>
<span class="va">rs.mix</span> <span class="op">&lt;-</span> <span class="fu">generate_miss_ls</span><span class="op">(</span><span class="va">X.complete</span>, <span class="va">miss_perc</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">list_df.con</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">rs.con</span><span class="op">$</span><span class="va">mcar</span><span class="op">$</span><span class="va">X.incomp</span>, <span class="va">rs.con</span><span class="op">$</span><span class="va">mar1</span><span class="op">$</span><span class="va">X.incomp</span>, <span class="va">rs.con</span><span class="op">$</span><span class="va">mar2</span><span class="op">$</span><span class="va">X.incomp</span>, <span class="va">rs.con</span><span class="op">$</span><span class="va">mar3</span><span class="op">$</span><span class="va">X.incomp</span>, <span class="va">rs.con</span><span class="op">$</span><span class="va">mnar1</span><span class="op">$</span><span class="va">X.incomp</span>, <span class="va">rs.con</span><span class="op">$</span><span class="va">mnar2</span><span class="op">$</span><span class="va">X.incomp</span><span class="op">)</span>

<span class="va">list_df.con_dis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">rs.con_dis</span><span class="op">$</span><span class="va">mcar</span><span class="op">$</span><span class="va">X.incomp</span>, <span class="va">rs.con_dis</span><span class="op">$</span><span class="va">mar1</span><span class="op">$</span><span class="va">X.incomp</span>, <span class="va">rs.con_dis</span><span class="op">$</span><span class="va">mar2</span><span class="op">$</span><span class="va">X.incomp</span>, <span class="va">rs.con_dis</span><span class="op">$</span><span class="va">mar3</span><span class="op">$</span><span class="va">X.incomp</span>, <span class="va">rs.con_dis</span><span class="op">$</span><span class="va">mnar1</span><span class="op">$</span><span class="va">X.incomp</span>, <span class="va">rs.con_dis</span><span class="op">$</span><span class="va">mnar2</span><span class="op">$</span><span class="va">X.incomp</span><span class="op">)</span>

<span class="va">list_df.mix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">rs.mix</span><span class="op">$</span><span class="va">mcar</span><span class="op">$</span><span class="va">X.incomp</span>, <span class="va">rs.mix</span><span class="op">$</span><span class="va">mar1</span><span class="op">$</span><span class="va">X.incomp</span>, <span class="va">rs.mix</span><span class="op">$</span><span class="va">mar2</span><span class="op">$</span><span class="va">X.incomp</span>, <span class="va">rs.mix</span><span class="op">$</span><span class="va">mar3</span><span class="op">$</span><span class="va">X.incomp</span>, <span class="va">rs.mix</span><span class="op">$</span><span class="va">mnar1</span><span class="op">$</span><span class="va">X.incomp</span>, <span class="va">rs.mix</span><span class="op">$</span><span class="va">mnar2</span><span class="op">$</span><span class="va">X.incomp</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="tests" class="section level1">
<h1 class="hasAnchor">
<a href="#tests" class="anchor"></a>Statistical tests for MCAR</h1>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p_val</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></code></pre></div>
<p>After the generation of incomplete datasets, we test if the missing data mechanism is MCAR by performing three classical statistic tests: the dummy variable test , Little’s MCAR test  from package  and the normality tests (Hawkin’s test and non-parametric test included)  from package . Our null hypothesis H0 is that the missing data mechanism is MCAR. As the normality test is only written for numerical data, here the test is performed on only the numerical part of the input dataframe.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu">mcar_test_combined</span><span class="op">(</span><span class="va">list_df.mix</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span>, col_cat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">8</span><span class="op">)</span>, p_val <span class="op">=</span> <span class="va">p_val</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "The normality test is written for numerical dataframes.\n          Here the test is performed on only the numerical part of the input dataframe.\n"
## Warning: 91 Cases with all variables missing have been removed 
## 
##         from the data.</code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">t</span><span class="op">$</span><span class="va">test_results</span><span class="op">)</span></code></pre></div>
<pre><code>##   Dummy.variable.test Little.s.MCAR.test MissMech.test
## 1               FALSE              FALSE          TRUE</code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># A dataframe that records the p-values for each test</span>
<span class="va">test_p_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">test_p_vals</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Dummy.variable.test"</span>, <span class="st">"Little.s.MCAR.test"</span>, <span class="st">"Hawkin.s.test"</span>, <span class="st">"Non.parametric.test"</span><span class="op">)</span>

<span class="va">ls_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"MCAR"</span>, <span class="st">"MAR1"</span>, <span class="st">"MAR2"</span>, <span class="st">"MAR3"</span>, <span class="st">"MNAR1"</span>, <span class="st">"MNAR2"</span><span class="op">)</span>
<span class="va">i</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">t</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">col_cat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">7</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">ls</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">list_df.con</span>, <span class="va">list_df.con_dis</span>, <span class="va">list_df.mix</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="kw">for</span> <span class="op">(</span><span class="va">df</span> <span class="kw">in</span> <span class="va">ls</span><span class="op">)</span> <span class="op">{</span>
    <span class="kw">if</span> <span class="op">(</span><span class="va">i</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span> <span class="op">{</span>
      <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/warning.html">suppressWarnings</a></span><span class="op">(</span><span class="fu">mcar_test_combined</span><span class="op">(</span><span class="va">df</span>, <span class="va">col_cat</span>, <span class="va">p_val</span><span class="op">)</span><span class="op">)</span>
    <span class="op">}</span>
    <span class="kw">else</span> <span class="op">{</span>
      <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/warning.html">suppressWarnings</a></span><span class="op">(</span><span class="fu">mcar_test_combined</span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">p_val</span><span class="op">)</span><span class="op">)</span>
    <span class="op">}</span>
    <span class="va">test_p_vals</span><span class="op">[</span><span class="va">t</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">out</span><span class="op">$</span><span class="va">p_values</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span>
    <span class="va">t</span> <span class="op">&lt;-</span> <span class="va">t</span> <span class="op">+</span> <span class="fl">1</span>
  <span class="op">}</span>
  <span class="va">i</span> <span class="op">&lt;-</span> <span class="va">i</span> <span class="op">+</span> <span class="fl">1</span>
<span class="op">}</span></code></pre></div>
<pre><code>## Warning: 151 Cases with all variables missing have been removed 
## 
##         from the data.
## Warning: 42 Cases with all variables missing have been removed 
## 
##         from the data.
## [1] "The normality test is written for numerical dataframes.\n          Here the test is performed on only the numerical part of the input dataframe.\n"
## Warning: 8 Cases with all variables missing have been removed 
## 
##         from the data.
## [1] "The normality test is written for numerical dataframes.\n          Here the test is performed on only the numerical part of the input dataframe.\n"
## Warning: 63 Cases with all variables missing have been removed 
## 
##         from the data.
## [1] "The normality test is written for numerical dataframes.\n          Here the test is performed on only the numerical part of the input dataframe.\n"
## [1] "The normality test is written for numerical dataframes.\n          Here the test is performed on only the numerical part of the input dataframe.\n"
## [1] "The normality test is written for numerical dataframes.\n          Here the test is performed on only the numerical part of the input dataframe.\n"
## Warning: 91 Cases with all variables missing have been removed 
## 
##         from the data.
## [1] "The normality test is written for numerical dataframes.\n          Here the test is performed on only the numerical part of the input dataframe.\n"
## Warning: 42 Cases with all variables missing have been removed 
## 
##         from the data.</code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">test_p_vals</span><span class="op">[[</span><span class="st">"type"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"continuous"</span>, <span class="fl">6</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"continuous+discrete"</span>, <span class="fl">6</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"mix"</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span>
<span class="va">test_p_vals</span><span class="op">[[</span><span class="st">"mechanism"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"MCAR"</span>, <span class="st">"MAR1"</span>, <span class="st">"MAR2"</span>, <span class="st">"MAR3"</span>, <span class="st">"MNAR1"</span>, <span class="st">"MNAR2"</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>
<span class="va">test_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">test_p_vals</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">]</span> <span class="op">&gt;</span> <span class="va">p_val</span><span class="op">)</span>
<span class="va">test_results</span><span class="op">[[</span><span class="st">"Miss_Mech_test"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">(</span><span class="va">test_p_vals</span><span class="op">[[</span><span class="st">"Hawkin.s.test"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;</span> <span class="va">p_val</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">test_p_vals</span><span class="op">[[</span><span class="st">"Non.parametric.test"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;</span> <span class="va">p_val</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span>
<span class="va">test_p_vals</span> <span class="op">&lt;-</span> <span class="va">test_p_vals</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"type"</span>, <span class="st">"mechanism"</span>, <span class="st">"Dummy.variable.test"</span>, <span class="st">"Little.s.MCAR.test"</span>, <span class="st">"Hawkin.s.test"</span>, <span class="st">"Non.parametric.test"</span><span class="op">)</span><span class="op">]</span>

<span class="va">test_p_vals</span></code></pre></div>
<pre><code>##                   type mechanism Dummy.variable.test Little.s.MCAR.test
## 1           continuous      MCAR           0.5337799          0.7533665
## 2           continuous      MAR1           0.0000000          0.0000000
## 3           continuous      MAR2           0.0000000          0.0000000
## 4           continuous      MAR3           0.0000000          0.0000000
## 5           continuous     MNAR1           0.0000000          0.0000000
## 6           continuous     MNAR2           0.0000000          0.0000000
## 7  continuous+discrete      MCAR           0.6444768          0.8492504
## 8  continuous+discrete      MAR1           0.0000000          0.0000000
## 9  continuous+discrete      MAR2           0.0000000          0.0000000
## 10 continuous+discrete      MAR3           0.0000000          0.0000000
## 11 continuous+discrete     MNAR1           0.0000000          0.0000000
## 12 continuous+discrete     MNAR2           0.0000000          0.0000000
## 13                 mix      MCAR           0.1299804          0.7260411
## 14                 mix      MAR1           0.0000000          0.0000000
## 15                 mix      MAR2           0.0000000          0.0000000
## 16                 mix      MAR3           0.0000000          0.0000000
## 17                 mix     MNAR1           0.0000000          0.0000000
## 18                 mix     MNAR2           0.0000000          0.0000000
##    Hawkin.s.test Non.parametric.test
## 1   4.870073e-01        4.503749e-01
## 2   6.114611e-01        6.147949e-01
## 3   7.187300e-19        0.000000e+00
## 4   2.658038e-78        0.000000e+00
## 5   8.086642e-02        1.263038e-01
## 6   1.143799e-61       7.278523e-273
## 7   8.042657e-01        4.139965e-01
## 8   9.941765e-01        9.875398e-01
## 9   1.630928e-16        0.000000e+00
## 10  1.789783e-77        0.000000e+00
## 11  3.910150e-01        7.613059e-01
## 12  1.262658e-42        1.224225e-75
## 13  4.004706e-01        7.163845e-01
## 14  6.396588e-01        4.003831e-01
## 15  1.630928e-16        0.000000e+00
## 16  1.179673e-77        0.000000e+00
## 17  2.408699e-01        4.830640e-01
## 18  1.262658e-42        1.224225e-75</code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">test_results</span> </code></pre></div>
<pre><code>##    Dummy.variable.test Little.s.MCAR.test Miss_Mech_test
## 1                 TRUE               TRUE           TRUE
## 2                FALSE              FALSE           TRUE
## 3                FALSE              FALSE          FALSE
## 4                FALSE              FALSE          FALSE
## 5                FALSE              FALSE           TRUE
## 6                FALSE              FALSE          FALSE
## 7                 TRUE               TRUE           TRUE
## 8                FALSE              FALSE           TRUE
## 9                FALSE              FALSE          FALSE
## 10               FALSE              FALSE          FALSE
## 11               FALSE              FALSE           TRUE
## 12               FALSE              FALSE          FALSE
## 13                TRUE               TRUE           TRUE
## 14               FALSE              FALSE           TRUE
## 15               FALSE              FALSE          FALSE
## 16               FALSE              FALSE          FALSE
## 17               FALSE              FALSE           TRUE
## 18               FALSE              FALSE          FALSE</code></pre>
<p>The result of MissMech test is not very accurate. This may due to the problem of implementation in MissMech package, which is not available on CRAN anymore.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Adrien Ehrhardt.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
