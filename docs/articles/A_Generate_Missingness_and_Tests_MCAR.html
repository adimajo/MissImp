<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Generation of Missingness and Tests of MCAR â€¢ MissImp</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Generation of Missingness and Tests of MCAR">
<meta property="og:description" content="MissImp">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MissImp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/A_Generate_Missingness_and_Tests_MCAR.html">Generation of Missingness and Tests of MCAR</a>
    </li>
    <li>
      <a href="../articles/B_MissImp_Test.html">MissImp Test</a>
    </li>
    <li>
      <a href="../articles/C_Each_Imputation_Method.html">Imputation for each method</a>
    </li>
    <li>
      <a href="../articles/D_oracle_simple_test.html">Oracle Simple Test</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Generation of Missingness and Tests of MCAR</h1>
                        <h4 data-toc-skip class="author">Xuwen Liu</h4>
            
            <h4 data-toc-skip class="date">2022-03-23</h4>
      
      
      <div class="hidden name"><code>A_Generate_Missingness_and_Tests_MCAR.Rmd</code></div>

    </div>

    
    
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">MissImp</span><span class="op">)</span></code></pre></div>
<p>In the <a href="#generate">first section</a>, some data are generated. first, <a href="#complete">a compete mixed-type dataset</a> is drawn with 5 continuous variables, 1 integer variable and 2 categorical variables. Then given the desired missing data proportion and the missing data mechanism, based on the complete dataset, <a href="#generate">an incomplete dataset</a> with missing values is created.</p>
<p>In the <a href="#tests">second section</a> of this document "Statistical tests for MCAR", three tests are performed to show if an incomplete dataset follows a Missing Completely At Random (MCAR) mechanism. These three tests are independently used on several generated incomplete datasets with different mechanisms, in order to show their capacity.</p>
<div class="section level2">
<h2 id="generate">Generate data<a class="anchor" aria-label="anchor" href="#generate"></a>
</h2>
<div class="section level3">
<h3 id="complete">Complete data<a class="anchor" aria-label="anchor" href="#complete"></a>
</h3>
<p>We generate a complete data set <span class="math inline">\((Y_j)_{1 \leq j \leq 8}\)</span> with <span class="math inline">\((Y_1, Y_2, Y_3) \sim \mathcal{N}(\mu_1, \Sigma_1)\)</span>, <span class="math inline">\((Y_4, Y_5) \sim \mathcal{N}(\mu_2, \Sigma_2)\)</span>, <span class="math inline">\(Y_6 \sim P(\lambda)\)</span> and <span class="math inline">\(Y_7, Y_8 \sim \text{Bin}(\gamma)\)</span>.</p>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">10000</span>
<span class="va">complete_df_generator</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">mu.X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>
  <span class="va">Sigma.X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>
    <span class="fl">9</span>, <span class="fl">3</span>, <span class="fl">2</span>,
    <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">0</span>,
    <span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">1</span>
  <span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
  <span class="co"># multivariate normal distribution</span>
  <span class="va">X.complete.cont</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">mu.X</span>, <span class="va">Sigma.X</span><span class="op">)</span>

  <span class="va">mu1.X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">8</span><span class="op">)</span>
  <span class="va">Sigma1.X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>
    <span class="fl">16</span>, <span class="fl">14</span>,
    <span class="fl">14</span>, <span class="fl">25</span>
  <span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
  <span class="co"># multivariate normal distribution</span>
  <span class="va">X.complete.cont1</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">mu1.X</span>, <span class="va">Sigma1.X</span><span class="op">)</span>

  <span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fl">4.3</span>
  <span class="co"># poisson distribution</span>
  <span class="va">X.complete.discr</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">lambda</span><span class="op">)</span>
  <span class="co"># binomial</span>
  <span class="va">X.complete.cat</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, size <span class="op">=</span> <span class="fl">5</span>, prob <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span>
  <span class="co"># binomial</span>
  <span class="va">X.complete.cat2</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, size <span class="op">=</span> <span class="fl">7</span>, prob <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span>

  <span class="va">X.complete</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">X.complete.cont</span>, <span class="va">X.complete.cont1</span>,
    <span class="va">X.complete.discr</span>,
    ... <span class="op">=</span> <span class="va">X.complete.cat</span>, <span class="va">X.complete.cat2</span>
  <span class="op">)</span><span class="op">)</span>
  <span class="va">X.complete</span><span class="op">[</span>, <span class="fl">7</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">X.complete</span><span class="op">[</span>, <span class="fl">7</span><span class="op">]</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">X.complete</span><span class="op">[</span>, <span class="fl">7</span><span class="op">]</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"F"</span>, <span class="st">"E"</span>, <span class="st">"D"</span>, <span class="st">"C"</span>, <span class="st">"B"</span>, <span class="st">"A"</span><span class="op">)</span>
  <span class="va">X.complete</span><span class="op">[</span>, <span class="fl">8</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">X.complete</span><span class="op">[</span>, <span class="fl">8</span><span class="op">]</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">X.complete</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Y1"</span>, <span class="st">"Y2"</span>, <span class="st">"Y3"</span>, <span class="st">"Y4"</span>, <span class="st">"Y5"</span>, <span class="st">"Y6"</span>, <span class="st">"Y7"</span>, <span class="st">"Y8"</span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">X.complete</span><span class="op">)</span>
<span class="op">}</span>
<span class="va">X.complete</span> <span class="op">&lt;-</span> <span class="fu">complete_df_generator</span><span class="op">(</span><span class="va">n</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="missingness">Add missingness<a class="anchor" aria-label="anchor" href="#missingness"></a>
</h3>
<p>We could generate incomplete dataframe from the complete dataframe, with a chosen percentage of missing data and a chosen missing mechanism. The difference between mechanisms is explained in the documentation of <code>generate_miss</code>.</p>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">miss_perc</span> <span class="op">&lt;-</span> <span class="fl">0.4</span>
<span class="va">rs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_miss.html">generate_miss</a></span><span class="op">(</span><span class="va">X.complete</span>, <span class="va">miss_perc</span>, mechanism <span class="op">=</span> <span class="st">"MNAR1"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rs</span><span class="op">$</span><span class="va">X.incomp</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##           Y1 Y2       Y3        Y4        Y5 Y6 Y7   Y8</span>
<span class="co">## 1  2.3334550 NA       NA  9.553147  9.741639 NA  D    4</span>
<span class="co">## 2 -0.9153648 NA 2.083208 12.147050 10.227267  1  D    0</span>
<span class="co">## 3 -2.6653332 NA       NA  9.047131  9.341351  4  D &lt;NA&gt;</span>
<span class="co">## 4         NA NA       NA        NA        NA NA  D    3</span>
<span class="co">## 5 -1.8255022 NA       NA        NA 16.624477 NA  D    5</span>
<span class="co">## 6  0.3716335 NA       NA        NA  9.145437  8  E    4</span></code></pre>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rs</span><span class="op">$</span><span class="va">R.mask</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##      Y1   Y2    Y3    Y4    Y5    Y6    Y7    Y8</span>
<span class="co">## 1 FALSE TRUE  TRUE FALSE FALSE  TRUE FALSE FALSE</span>
<span class="co">## 2 FALSE TRUE FALSE FALSE FALSE FALSE FALSE FALSE</span>
<span class="co">## 3 FALSE TRUE  TRUE FALSE FALSE FALSE FALSE  TRUE</span>
<span class="co">## 4  TRUE TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE</span>
<span class="co">## 5 FALSE TRUE  TRUE  TRUE FALSE  TRUE FALSE FALSE</span>
<span class="co">## 6 FALSE TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE</span></code></pre>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">rs</span><span class="op">$</span><span class="va">real_miss_perc</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 0.4008625</span></code></pre>
<p>Next, a list of incomplete dataframes is generated with every mechanism that is implemented in <code>generate_miss</code>. First a list of incomplete dataframes is generated on the continuous variables <span class="math inline">\((Y_1, \dots, Y_5)\)</span>, with the result in <code>rs.con</code>; then on the continous + discrete variables <span class="math inline">\((Y_1, \dots, Y_6)\)</span>, with the result in <code>rs.con_dis</code>; and at last on continuous + discrete + categorical variables, with the result in <code>rs.mix</code>.</p>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">miss_perc</span> <span class="op">&lt;-</span> <span class="fl">0.3</span>
<span class="va">rs.con</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_miss_ls.html">generate_miss_ls</a></span><span class="op">(</span><span class="va">X.complete</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, <span class="va">miss_perc</span><span class="op">)</span>
<span class="va">rs.con_dis</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_miss_ls.html">generate_miss_ls</a></span><span class="op">(</span><span class="va">X.complete</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span>, <span class="va">miss_perc</span><span class="op">)</span>
<span class="va">rs.mix</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_miss_ls.html">generate_miss_ls</a></span><span class="op">(</span><span class="va">X.complete</span>, <span class="va">miss_perc</span><span class="op">)</span></code></pre></div>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">list_df.con</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">rs.con</span><span class="op">$</span><span class="va">mcar</span><span class="op">$</span><span class="va">X.incomp</span>, <span class="va">rs.con</span><span class="op">$</span><span class="va">mar1</span><span class="op">$</span><span class="va">X.incomp</span>, <span class="va">rs.con</span><span class="op">$</span><span class="va">mar2</span><span class="op">$</span><span class="va">X.incomp</span>, <span class="va">rs.con</span><span class="op">$</span><span class="va">mar3</span><span class="op">$</span><span class="va">X.incomp</span>, <span class="va">rs.con</span><span class="op">$</span><span class="va">mnar1</span><span class="op">$</span><span class="va">X.incomp</span>, <span class="va">rs.con</span><span class="op">$</span><span class="va">mnar2</span><span class="op">$</span><span class="va">X.incomp</span><span class="op">)</span>

<span class="va">list_df.con_dis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">rs.con_dis</span><span class="op">$</span><span class="va">mcar</span><span class="op">$</span><span class="va">X.incomp</span>, <span class="va">rs.con_dis</span><span class="op">$</span><span class="va">mar1</span><span class="op">$</span><span class="va">X.incomp</span>, <span class="va">rs.con_dis</span><span class="op">$</span><span class="va">mar2</span><span class="op">$</span><span class="va">X.incomp</span>, <span class="va">rs.con_dis</span><span class="op">$</span><span class="va">mar3</span><span class="op">$</span><span class="va">X.incomp</span>, <span class="va">rs.con_dis</span><span class="op">$</span><span class="va">mnar1</span><span class="op">$</span><span class="va">X.incomp</span>, <span class="va">rs.con_dis</span><span class="op">$</span><span class="va">mnar2</span><span class="op">$</span><span class="va">X.incomp</span><span class="op">)</span>

<span class="va">list_df.mix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">rs.mix</span><span class="op">$</span><span class="va">mcar</span><span class="op">$</span><span class="va">X.incomp</span>, <span class="va">rs.mix</span><span class="op">$</span><span class="va">mar1</span><span class="op">$</span><span class="va">X.incomp</span>, <span class="va">rs.mix</span><span class="op">$</span><span class="va">mar2</span><span class="op">$</span><span class="va">X.incomp</span>, <span class="va">rs.mix</span><span class="op">$</span><span class="va">mar3</span><span class="op">$</span><span class="va">X.incomp</span>, <span class="va">rs.mix</span><span class="op">$</span><span class="va">mnar1</span><span class="op">$</span><span class="va">X.incomp</span>, <span class="va">rs.mix</span><span class="op">$</span><span class="va">mnar2</span><span class="op">$</span><span class="va">X.incomp</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="tests">Statistical tests for MCAR<a class="anchor" aria-label="anchor" href="#tests"></a>
</h2>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p_val</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></code></pre></div>
<p>After the generation of incomplete datasets, we test if the missing data mechanism is MCAR by performing three classical statistic tests: the dummy variable test , Little's MCAR test  from package  and the normality tests (Hawkin's test and non-parametric test included)  from package . Our null hypothesis H0 is that the missing data mechanism is MCAR. As the normality test is only written for numerical data, here the test is performed on only the numerical part of the input dataframe.</p>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mcar_test_combined.html">mcar_test_combined</a></span><span class="op">(</span><span class="va">list_df.mix</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span>, col_cat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">8</span><span class="op">)</span>, p_val <span class="op">=</span> <span class="va">p_val</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] "The normality test is written for numerical dataframes.\n          Here the test is performed on only the numerical part of the input\n          dataframe.\n"</span>
<span class="co">## Warning: 87 Cases with all variables missing</span>
<span class="co">##     have been removed from the data.</span></code></pre>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">t</span><span class="op">$</span><span class="va">test_results</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##   Dummy.variable.test Little.s.MCAR.test MissMech.test</span>
<span class="co">## 1               FALSE              FALSE          TRUE</span></code></pre>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># A dataframe that records the p-values for each test</span>
<span class="va">test_p_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">test_p_vals</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Dummy.variable.test"</span>, <span class="st">"Little.s.MCAR.test"</span>, <span class="st">"Hawkin.s.test"</span>, <span class="st">"Non.parametric.test"</span><span class="op">)</span>

<span class="va">ls_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"MCAR"</span>, <span class="st">"MAR1"</span>, <span class="st">"MAR2"</span>, <span class="st">"MAR3"</span>, <span class="st">"MNAR1"</span>, <span class="st">"MNAR2"</span><span class="op">)</span>
<span class="va">i</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">t</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">col_cat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">ls</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">list_df.con</span>, <span class="va">list_df.con_dis</span>, <span class="va">list_df.mix</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="kw">for</span> <span class="op">(</span><span class="va">df</span> <span class="kw">in</span> <span class="va">ls</span><span class="op">)</span> <span class="op">{</span>
    <span class="kw">if</span> <span class="op">(</span><span class="va">i</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span> <span class="op">{</span>
      <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="../reference/mcar_test_combined.html">mcar_test_combined</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">col_cat</span>, <span class="va">p_val</span><span class="op">)</span><span class="op">)</span>
    <span class="op">}</span>
    <span class="kw">else</span> <span class="op">{</span>
      <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="../reference/mcar_test_combined.html">mcar_test_combined</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">p_val</span><span class="op">)</span><span class="op">)</span>
    <span class="op">}</span>
    <span class="va">test_p_vals</span><span class="op">[</span><span class="va">t</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">out</span><span class="op">$</span><span class="va">p_values</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span>
    <span class="va">t</span> <span class="op">&lt;-</span> <span class="va">t</span> <span class="op">+</span> <span class="fl">1</span>
  <span class="op">}</span>
  <span class="va">i</span> <span class="op">&lt;-</span> <span class="va">i</span> <span class="op">+</span> <span class="fl">1</span>
<span class="op">}</span></code></pre></div>
<pre><code><span class="co">## Warning: 148 Cases with all variables missing</span>
<span class="co">##     have been removed from the data.</span>
<span class="co">## Warning: 54 Cases with all variables missing</span>
<span class="co">##     have been removed from the data.</span>
<span class="co">## [1] "The normality test is written for numerical dataframes.\n          Here the test is performed on only the numerical part of the input\n          dataframe.\n"</span>
<span class="co">## Warning: 9 Cases with all variables missing</span>
<span class="co">##     have been removed from the data.</span>
<span class="co">## [1] "The normality test is written for numerical dataframes.\n          Here the test is performed on only the numerical part of the input\n          dataframe.\n"</span>
<span class="co">## Warning: 69 Cases with all variables missing</span>
<span class="co">##     have been removed from the data.</span>
<span class="co">## [1] "The normality test is written for numerical dataframes.\n          Here the test is performed on only the numerical part of the input\n          dataframe.\n"</span>
<span class="co">## [1] "The normality test is written for numerical dataframes.\n          Here the test is performed on only the numerical part of the input\n          dataframe.\n"</span>
<span class="co">## [1] "The normality test is written for numerical dataframes.\n          Here the test is performed on only the numerical part of the input\n          dataframe.\n"</span>
<span class="co">## Warning: 87 Cases with all variables missing</span>
<span class="co">##     have been removed from the data.</span>
<span class="co">## [1] "The normality test is written for numerical dataframes.\n          Here the test is performed on only the numerical part of the input\n          dataframe.\n"</span>
<span class="co">## Warning: 54 Cases with all variables missing</span>
<span class="co">##     have been removed from the data.</span></code></pre>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">test_p_vals</span><span class="op">[[</span><span class="st">"type"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"continuous"</span>, <span class="fl">6</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"continuous+discrete"</span>, <span class="fl">6</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"mix"</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span>
<span class="va">test_p_vals</span><span class="op">[[</span><span class="st">"mechanism"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MCAR"</span>, <span class="st">"MAR1"</span>, <span class="st">"MAR2"</span>, <span class="st">"MAR3"</span>, <span class="st">"MNAR1"</span>, <span class="st">"MNAR2"</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>
<span class="va">test_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">test_p_vals</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">]</span> <span class="op">&gt;</span> <span class="va">p_val</span><span class="op">)</span>
<span class="va">test_results</span><span class="op">[[</span><span class="st">"Miss_Mech_test"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">(</span><span class="va">test_p_vals</span><span class="op">[[</span><span class="st">"Hawkin.s.test"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;</span> <span class="va">p_val</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">test_p_vals</span><span class="op">[[</span><span class="st">"Non.parametric.test"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;</span> <span class="va">p_val</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span>
<span class="va">test_p_vals</span> <span class="op">&lt;-</span> <span class="va">test_p_vals</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"type"</span>, <span class="st">"mechanism"</span>, <span class="st">"Dummy.variable.test"</span>, <span class="st">"Little.s.MCAR.test"</span>, <span class="st">"Hawkin.s.test"</span>, <span class="st">"Non.parametric.test"</span><span class="op">)</span><span class="op">]</span>

<span class="va">test_p_vals</span></code></pre></div>
<pre><code><span class="co">##                   type mechanism Dummy.variable.test Little.s.MCAR.test</span>
<span class="co">## 1           continuous      MCAR           0.8360290          0.4075070</span>
<span class="co">## 2           continuous      MAR1           0.0000000          0.0000000</span>
<span class="co">## 3           continuous      MAR2           0.0000000          0.0000000</span>
<span class="co">## 4           continuous      MAR3           0.0000000          0.0000000</span>
<span class="co">## 5           continuous     MNAR1           0.0000000          0.0000000</span>
<span class="co">## 6           continuous     MNAR2           0.0000000          0.0000000</span>
<span class="co">## 7  continuous+discrete      MCAR           0.2661636          0.7189364</span>
<span class="co">## 8  continuous+discrete      MAR1           0.0000000          0.0000000</span>
<span class="co">## 9  continuous+discrete      MAR2           0.0000000          0.0000000</span>
<span class="co">## 10 continuous+discrete      MAR3           0.0000000          0.0000000</span>
<span class="co">## 11 continuous+discrete     MNAR1           0.0000000          0.0000000</span>
<span class="co">## 12 continuous+discrete     MNAR2           0.0000000          0.0000000</span>
<span class="co">## 13                 mix      MCAR           0.7703269          0.7016833</span>
<span class="co">## 14                 mix      MAR1           0.0000000          0.0000000</span>
<span class="co">## 15                 mix      MAR2           0.0000000          0.0000000</span>
<span class="co">## 16                 mix      MAR3           0.0000000          0.0000000</span>
<span class="co">## 17                 mix     MNAR1           0.0000000          0.0000000</span>
<span class="co">## 18                 mix     MNAR2           0.0000000          0.0000000</span>
<span class="co">##    Hawkin.s.test Non.parametric.test</span>
<span class="co">## 1   9.867741e-02        8.143071e-02</span>
<span class="co">## 2   5.698085e-01        1.296066e-01</span>
<span class="co">## 3   9.962551e-19        0.000000e+00</span>
<span class="co">## 4   1.811646e-58        0.000000e+00</span>
<span class="co">## 5   4.657389e-01        3.736963e-01</span>
<span class="co">## 6   1.265619e-53        0.000000e+00</span>
<span class="co">## 7   9.922072e-01        9.449422e-01</span>
<span class="co">## 8   2.202580e-01        3.717846e-02</span>
<span class="co">## 9   2.713581e-16        0.000000e+00</span>
<span class="co">## 10  5.653014e-59        0.000000e+00</span>
<span class="co">## 11  5.793144e-03        8.008206e-04</span>
<span class="co">## 12  2.321045e-37        1.764572e-82</span>
<span class="co">## 13  6.177266e-01        7.924084e-01</span>
<span class="co">## 14  5.508876e-01        4.858483e-01</span>
<span class="co">## 15  2.713581e-16        0.000000e+00</span>
<span class="co">## 16  1.571987e-60        0.000000e+00</span>
<span class="co">## 17  3.740420e-01        4.238728e-01</span>
<span class="co">## 18  2.321045e-37        1.764572e-82</span></code></pre>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">test_results</span> </code></pre></div>
<pre><code><span class="co">##    Dummy.variable.test Little.s.MCAR.test Miss_Mech_test</span>
<span class="co">## 1                 TRUE               TRUE           TRUE</span>
<span class="co">## 2                FALSE              FALSE           TRUE</span>
<span class="co">## 3                FALSE              FALSE          FALSE</span>
<span class="co">## 4                FALSE              FALSE          FALSE</span>
<span class="co">## 5                FALSE              FALSE           TRUE</span>
<span class="co">## 6                FALSE              FALSE          FALSE</span>
<span class="co">## 7                 TRUE               TRUE           TRUE</span>
<span class="co">## 8                FALSE              FALSE           TRUE</span>
<span class="co">## 9                FALSE              FALSE          FALSE</span>
<span class="co">## 10               FALSE              FALSE          FALSE</span>
<span class="co">## 11               FALSE              FALSE          FALSE</span>
<span class="co">## 12               FALSE              FALSE          FALSE</span>
<span class="co">## 13                TRUE               TRUE           TRUE</span>
<span class="co">## 14               FALSE              FALSE           TRUE</span>
<span class="co">## 15               FALSE              FALSE          FALSE</span>
<span class="co">## 16               FALSE              FALSE          FALSE</span>
<span class="co">## 17               FALSE              FALSE           TRUE</span>
<span class="co">## 18               FALSE              FALSE          FALSE</span></code></pre>
<p>The result of MissMech test is not very accurate. This may due to the problem of implementation in MissMech package, which is not available on CRAN anymore.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Adrien Ehrhardt.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
